<md-card class="top-filter">

  <md-select placeholder="Отчеты" [(ngModel)]="currentReport" (ngModelChange)="changeReports($event)" [disabled]="!reports.length">
    <md-option *ngFor="let report of reports" [value]="report">
      {{ report.name }}
    </md-option>
  </md-select>

  <md-select placeholder="Маршруты" [(ngModel)]="currentdRoutes" [multiple]="true" (ngModelChange)="changeRoutes($event)">
    <md-option *ngFor="let route of listRoutes" [value]="getSelected(currentdRoutes, route)">
      {{ route.description }}
    </md-option>
  </md-select>

  <md-select placeholder="Показатели" [(ngModel)]="currentIndicators" [multiple]="true" (ngModelChange)="changeIndicators($event)">
    <md-option *ngFor="let indicator of indicators" [value]="getSelected(currentIndicators, indicator)">
      {{ indicator.description }}
    </md-option>
  </md-select>
  <button md-mini-fab (click)="applyFilter()"><md-icon>filter_list</md-icon></button>
  <md-icon class="report-config" (click)="openConfig()">settings</md-icon>
</md-card>

<md-card *ngIf="routesData && currentReport && listIndicators">
  <table class="table  table-hover table-condensed table-responsive dataTables-example">
    <thead>
      <tr>
        <td></td>
        <td *ngFor="let indicator of currentIndicators" [attr.colspan]="indicator.fields.length" class="indicator-header">
          {{indicator.name}}
        </td>
      </tr>
      <tr>
        <td>Маршрут</td>
        <ng-template ngFor let-indicator [ngForOf]="currentIndicators">
          <td *ngFor="let field of indicator.fields" [hidden]="hideElement">
            {{field.description}}
          </td>
        </ng-template>

      </tr>
    </thead>
    <tbody plan-detail-row [route]="route" [indicators]=[listIndicators] *ngFor="let route of routesData"></tbody>
  </table>
</md-card>

<app-filterbar *ngIf="indicators && currentIndicators" [indicators]="indicators" [currentReport]="currentReport" [currentIndicators]="currentIndicators"></app-filterbar>